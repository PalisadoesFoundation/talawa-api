"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[67215],{23105:(e,s,c)=>{c.r(s),c.d(s,{assets:()=>a,contentTitle:()=>d,default:()=>o,frontMatter:()=>n,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"auto-docs/services/metrics/metricsCache/classes/MetricsCacheService","title":"MetricsCacheService","description":"API Docs","source":"@site/docs/auto-docs/services/metrics/metricsCache/classes/MetricsCacheService.md","sourceDirName":"auto-docs/services/metrics/metricsCache/classes","slug":"/auto-docs/services/metrics/metricsCache/classes/MetricsCacheService","permalink":"/docs/auto-docs/services/metrics/metricsCache/classes/MetricsCacheService","draft":false,"unlisted":false,"editUrl":"https://github.com/PalisadoesFoundation/talawa-api/edit/develop/docs/docs/auto-docs/services/metrics/metricsCache/classes/MetricsCacheService.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"validateWindowConfig","permalink":"/docs/auto-docs/services/eventGeneration/windowManager/functions/validateWindowConfig"},"next":{"title":"metricsCacheProxy","permalink":"/docs/auto-docs/services/metrics/metricsCacheProxy/functions/metricsCacheProxy"}}');var i=c(86070),t=c(55288);const n={},d=void 0,a={},l=[{value:"Constructors",id:"constructors",level:2},{value:"Constructor",id:"constructor",level:3},{value:"Parameters",id:"parameters",level:4},{value:"cache",id:"cache",level:5},{value:"logger?",id:"logger",level:5},{value:"defaultTtlSeconds?",id:"defaultttlseconds",level:5},{value:"Returns",id:"returns",level:4},{value:"Methods",id:"methods",level:2},{value:"cacheAggregatedMetrics()",id:"cacheaggregatedmetrics",level:3},{value:"Parameters",id:"parameters-1",level:4},{value:"metrics",id:"metrics",level:5},{value:"timestamp",id:"timestamp",level:5},{value:"ttlSeconds?",id:"ttlseconds",level:5},{value:"Returns",id:"returns-1",level:4},{value:"Example",id:"example",level:4},{value:"cacheWindowedMetrics()",id:"cachewindowedmetrics",level:3},{value:"Parameters",id:"parameters-2",level:4},{value:"metrics",id:"metrics-1",level:5},{value:"windowType",id:"windowtype",level:5},{value:"date",id:"date",level:5},{value:"ttlSeconds?",id:"ttlseconds-1",level:5},{value:"Returns",id:"returns-2",level:4},{value:"Example",id:"example-1",level:4},{value:"getCachedMetrics()",id:"getcachedmetrics",level:3},{value:"Parameters",id:"parameters-3",level:4},{value:"timestamp",id:"timestamp-1",level:5},{value:"Returns",id:"returns-3",level:4},{value:"Example",id:"example-2",level:4},{value:"getCachedMetricsByWindow()",id:"getcachedmetricsbywindow",level:3},{value:"Parameters",id:"parameters-4",level:4},{value:"windowType",id:"windowtype-1",level:5},{value:"date",id:"date-1",level:5},{value:"Returns",id:"returns-4",level:4},{value:"Example",id:"example-3",level:4},{value:"invalidateMetricsCache()",id:"invalidatemetricscache",level:3},{value:"Parameters",id:"parameters-5",level:4},{value:"pattern?",id:"pattern",level:5},{value:"Returns",id:"returns-5",level:4},{value:"Example",id:"example-4",level:4}];function h(e){const s={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"/",children:"API Docs"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h1,{id:"class-metricscacheservice",children:"Class: MetricsCacheService"}),"\n",(0,i.jsxs)(s.p,{children:["Defined in: ",(0,i.jsx)(s.a,{href:"https://github.com/PalisadoesFoundation/talawa-api/tree/mainsrc/services/metrics/metricsCache.ts#L21",children:"src/services/metrics/metricsCache.ts:21"})]}),"\n",(0,i.jsx)(s.p,{children:"Service for caching aggregated metrics data.\nProvides methods to cache and retrieve metrics snapshots with configurable TTL."}),"\n",(0,i.jsx)(s.p,{children:"All cache operations are wrapped with try/catch for graceful degradation.\nCache failures should not break metrics collection or request handling."}),"\n",(0,i.jsx)(s.h2,{id:"constructors",children:"Constructors"}),"\n",(0,i.jsx)(s.h3,{id:"constructor",children:"Constructor"}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"new MetricsCacheService"}),"(",(0,i.jsx)(s.code,{children:"cache"}),", ",(0,i.jsx)(s.code,{children:"logger?"}),", ",(0,i.jsx)(s.code,{children:"defaultTtlSeconds?"}),"): ",(0,i.jsx)(s.code,{children:"MetricsCacheService"})]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Defined in: ",(0,i.jsx)(s.a,{href:"https://github.com/PalisadoesFoundation/talawa-api/tree/mainsrc/services/metrics/metricsCache.ts#L22",children:"src/services/metrics/metricsCache.ts:22"})]}),"\n",(0,i.jsx)(s.h4,{id:"parameters",children:"Parameters"}),"\n",(0,i.jsx)(s.h5,{id:"cache",children:"cache"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"/docs/auto-docs/services/caching/CacheService/interfaces/CacheService",children:(0,i.jsx)(s.code,{children:"CacheService"})})}),"\n",(0,i.jsx)(s.h5,{id:"logger",children:"logger?"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"Logger"})}),"\n",(0,i.jsx)(s.h5,{id:"defaultttlseconds",children:"defaultTtlSeconds?"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"number"})," = ",(0,i.jsx)(s.code,{children:"300"})]}),"\n",(0,i.jsx)(s.h4,{id:"returns",children:"Returns"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"MetricsCacheService"})}),"\n",(0,i.jsx)(s.h2,{id:"methods",children:"Methods"}),"\n",(0,i.jsx)(s.h3,{id:"cacheaggregatedmetrics",children:"cacheAggregatedMetrics()"}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"cacheAggregatedMetrics"}),"(",(0,i.jsx)(s.code,{children:"metrics"}),", ",(0,i.jsx)(s.code,{children:"timestamp"}),", ",(0,i.jsx)(s.code,{children:"ttlSeconds?"}),"): ",(0,i.jsx)(s.code,{children:"Promise"}),"<",(0,i.jsx)(s.code,{children:"void"}),">"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Defined in: ",(0,i.jsx)(s.a,{href:"https://github.com/PalisadoesFoundation/talawa-api/tree/mainsrc/services/metrics/metricsCache.ts#L41",children:"src/services/metrics/metricsCache.ts:41"})]}),"\n",(0,i.jsx)(s.p,{children:"Cache aggregated metrics with a timestamp identifier."}),"\n",(0,i.jsx)(s.h4,{id:"parameters-1",children:"Parameters"}),"\n",(0,i.jsx)(s.h5,{id:"metrics",children:"metrics"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"/docs/auto-docs/workers/metrics/types/interfaces/AggregatedMetrics",children:(0,i.jsx)(s.code,{children:"AggregatedMetrics"})})}),"\n",(0,i.jsx)(s.p,{children:"The aggregated metrics to cache"}),"\n",(0,i.jsx)(s.h5,{id:"timestamp",children:"timestamp"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"string"})}),"\n",(0,i.jsx)(s.p,{children:"Timestamp identifier (milliseconds since epoch as string)"}),"\n",(0,i.jsx)(s.h5,{id:"ttlseconds",children:"ttlSeconds?"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"number"})}),"\n",(0,i.jsx)(s.p,{children:"Optional TTL override (defaults to configured default)"}),"\n",(0,i.jsx)(s.h4,{id:"returns-1",children:"Returns"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"Promise"}),"<",(0,i.jsx)(s.code,{children:"void"}),">"]}),"\n",(0,i.jsx)(s.p,{children:"Promise that resolves when caching is complete (or fails silently)"}),"\n",(0,i.jsx)(s.h4,{id:"example",children:"Example"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:'await metricsCache.cacheAggregatedMetrics(metrics, "1705320000000", 600);\n'})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"cachewindowedmetrics",children:"cacheWindowedMetrics()"}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"cacheWindowedMetrics"}),"(",(0,i.jsx)(s.code,{children:"metrics"}),", ",(0,i.jsx)(s.code,{children:"windowType"}),", ",(0,i.jsx)(s.code,{children:"date"}),", ",(0,i.jsx)(s.code,{children:"ttlSeconds?"}),"): ",(0,i.jsx)(s.code,{children:"Promise"}),"<",(0,i.jsx)(s.code,{children:"void"}),">"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Defined in: ",(0,i.jsx)(s.a,{href:"https://github.com/PalisadoesFoundation/talawa-api/tree/mainsrc/services/metrics/metricsCache.ts#L214",children:"src/services/metrics/metricsCache.ts:214"})]}),"\n",(0,i.jsx)(s.p,{children:"Cache aggregated metrics for a time window (hourly or daily)."}),"\n",(0,i.jsx)(s.h4,{id:"parameters-2",children:"Parameters"}),"\n",(0,i.jsx)(s.h5,{id:"metrics-1",children:"metrics"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.a,{href:"/docs/auto-docs/workers/metrics/types/interfaces/AggregatedMetrics",children:(0,i.jsx)(s.code,{children:"AggregatedMetrics"})})}),"\n",(0,i.jsx)(s.p,{children:"The aggregated metrics to cache"}),"\n",(0,i.jsx)(s.h5,{id:"windowtype",children:"windowType"}),"\n",(0,i.jsx)(s.p,{children:"Type of time window ('hourly' or 'daily')"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:'"hourly"'})," | ",(0,i.jsx)(s.code,{children:'"daily"'})]}),"\n",(0,i.jsx)(s.h5,{id:"date",children:"date"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"string"})}),"\n",(0,i.jsx)(s.p,{children:"Date string in format 'YYYY-MM-DD' for daily or 'YYYY-MM-DD-HH' for hourly"}),"\n",(0,i.jsx)(s.h5,{id:"ttlseconds-1",children:"ttlSeconds?"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"number"})}),"\n",(0,i.jsx)(s.p,{children:"Optional TTL override (defaults to longer TTL for windowed metrics)"}),"\n",(0,i.jsx)(s.h4,{id:"returns-2",children:"Returns"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"Promise"}),"<",(0,i.jsx)(s.code,{children:"void"}),">"]}),"\n",(0,i.jsx)(s.p,{children:"Promise that resolves when caching is complete (or fails silently)"}),"\n",(0,i.jsx)(s.h4,{id:"example-1",children:"Example"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"// Cache hourly metrics with default TTL (3600 seconds)\nawait metricsCache.cacheWindowedMetrics(metrics, 'hourly', '2024-01-15-14');\n\n// Cache daily metrics with custom TTL\nawait metricsCache.cacheWindowedMetrics(metrics, 'daily', '2024-01-15', 86400);\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"getcachedmetrics",children:"getCachedMetrics()"}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"getCachedMetrics"}),"(",(0,i.jsx)(s.code,{children:"timestamp"}),"): ",(0,i.jsx)(s.code,{children:"Promise"}),"<",(0,i.jsx)(s.a,{href:"/docs/auto-docs/workers/metrics/types/interfaces/AggregatedMetrics",children:(0,i.jsx)(s.code,{children:"AggregatedMetrics"})})," | ",(0,i.jsx)(s.code,{children:"null"}),">"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Defined in: ",(0,i.jsx)(s.a,{href:"https://github.com/PalisadoesFoundation/talawa-api/tree/mainsrc/services/metrics/metricsCache.ts#L113",children:"src/services/metrics/metricsCache.ts:113"})]}),"\n",(0,i.jsx)(s.p,{children:"Retrieve cached aggregated metrics by timestamp."}),"\n",(0,i.jsx)(s.h4,{id:"parameters-3",children:"Parameters"}),"\n",(0,i.jsx)(s.h5,{id:"timestamp-1",children:"timestamp"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"string"})}),"\n",(0,i.jsx)(s.p,{children:"Timestamp identifier (milliseconds since epoch as string)"}),"\n",(0,i.jsx)(s.h4,{id:"returns-3",children:"Returns"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"Promise"}),"<",(0,i.jsx)(s.a,{href:"/docs/auto-docs/workers/metrics/types/interfaces/AggregatedMetrics",children:(0,i.jsx)(s.code,{children:"AggregatedMetrics"})})," | ",(0,i.jsx)(s.code,{children:"null"}),">"]}),"\n",(0,i.jsx)(s.p,{children:"Cached metrics or null if not found/expired"}),"\n",(0,i.jsx)(s.h4,{id:"example-2",children:"Example"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:'const metrics = await metricsCache.getCachedMetrics("1705320000000");\nif (metrics) {\n  // Use cached metrics\n}\n'})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"getcachedmetricsbywindow",children:"getCachedMetricsByWindow()"}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"getCachedMetricsByWindow"}),"(",(0,i.jsx)(s.code,{children:"windowType"}),", ",(0,i.jsx)(s.code,{children:"date"}),"): ",(0,i.jsx)(s.code,{children:"Promise"}),"<",(0,i.jsx)(s.a,{href:"/docs/auto-docs/workers/metrics/types/interfaces/AggregatedMetrics",children:(0,i.jsx)(s.code,{children:"AggregatedMetrics"})})," | ",(0,i.jsx)(s.code,{children:"null"}),">"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Defined in: ",(0,i.jsx)(s.a,{href:"https://github.com/PalisadoesFoundation/talawa-api/tree/mainsrc/services/metrics/metricsCache.ts#L160",children:"src/services/metrics/metricsCache.ts:160"})]}),"\n",(0,i.jsx)(s.p,{children:"Retrieve cached aggregated metrics by time window (hourly or daily)."}),"\n",(0,i.jsx)(s.h4,{id:"parameters-4",children:"Parameters"}),"\n",(0,i.jsx)(s.h5,{id:"windowtype-1",children:"windowType"}),"\n",(0,i.jsx)(s.p,{children:"Type of time window ('hourly' or 'daily')"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:'"hourly"'})," | ",(0,i.jsx)(s.code,{children:'"daily"'})]}),"\n",(0,i.jsx)(s.h5,{id:"date-1",children:"date"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"string"})}),"\n",(0,i.jsx)(s.p,{children:"Date string in format 'YYYY-MM-DD' for daily or 'YYYY-MM-DD-HH' for hourly"}),"\n",(0,i.jsx)(s.h4,{id:"returns-4",children:"Returns"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"Promise"}),"<",(0,i.jsx)(s.a,{href:"/docs/auto-docs/workers/metrics/types/interfaces/AggregatedMetrics",children:(0,i.jsx)(s.code,{children:"AggregatedMetrics"})})," | ",(0,i.jsx)(s.code,{children:"null"}),">"]}),"\n",(0,i.jsx)(s.p,{children:"Cached metrics or null if not found/expired"}),"\n",(0,i.jsx)(s.h4,{id:"example-3",children:"Example"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"// Get hourly metrics for 2024-01-15 at 14:00\nconst metrics = await metricsCache.getCachedMetricsByWindow('hourly', '2024-01-15-14');\n\n// Get daily metrics for 2024-01-15\nconst metrics = await metricsCache.getCachedMetricsByWindow('daily', '2024-01-15');\n"})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h3,{id:"invalidatemetricscache",children:"invalidateMetricsCache()"}),"\n",(0,i.jsxs)(s.blockquote,{children:["\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"invalidateMetricsCache"}),"(",(0,i.jsx)(s.code,{children:"pattern?"}),"): ",(0,i.jsx)(s.code,{children:"Promise"}),"<",(0,i.jsx)(s.code,{children:"void"}),">"]}),"\n"]}),"\n",(0,i.jsxs)(s.p,{children:["Defined in: ",(0,i.jsx)(s.a,{href:"https://github.com/PalisadoesFoundation/talawa-api/tree/mainsrc/services/metrics/metricsCache.ts#L293",children:"src/services/metrics/metricsCache.ts:293"})]}),"\n",(0,i.jsx)(s.p,{children:"Invalidate metrics cache entries matching a pattern."}),"\n",(0,i.jsx)(s.h4,{id:"parameters-5",children:"Parameters"}),"\n",(0,i.jsx)(s.h5,{id:"pattern",children:"pattern?"}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.code,{children:"string"})}),"\n",(0,i.jsxs)(s.p,{children:['Optional glob pattern (e.g., "metrics:aggregated:',(0,i.jsx)(s.em,{children:'" or "metrics:aggregated:hourly:'}),'")\nIf not provided, invalidates all metrics cache entries']}),"\n",(0,i.jsx)(s.h4,{id:"returns-5",children:"Returns"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.code,{children:"Promise"}),"<",(0,i.jsx)(s.code,{children:"void"}),">"]}),"\n",(0,i.jsx)(s.p,{children:"Promise that resolves when invalidation is complete (or fails silently)"}),"\n",(0,i.jsx)(s.h4,{id:"example-4",children:"Example"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:'// Invalidate all metrics\nawait metricsCache.invalidateMetricsCache();\n\n// Invalidate only hourly metrics\nawait metricsCache.invalidateMetricsCache("aggregated:hourly:*");\n'})})]})}function o(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},55288:(e,s,c)=>{c.d(s,{R:()=>n,x:()=>d});var r=c(30758);const i={},t=r.createContext(i);function n(e){const s=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:n(e.components),r.createElement(t.Provider,{value:s},e.children)}}}]);